{"ast":null,"code":"// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport { Framework } from './types';\nimport { detect } from './detection';\n// We want to cache detection since the framework won't change\nvar frameworkCache;\nvar frameworkChangeObservers = [];\n// Setup the detection reset tracking / timeout delays\nvar resetTriggered = false;\nvar SSR_RESET_TIMEOUT = 10; // ms\nvar WEB_RESET_TIMEOUT = 10; // ms\nvar PRIME_FRAMEWORK_DELAY = 1000; // ms\nexport var detectFramework = function () {\n  if (!frameworkCache) {\n    frameworkCache = detect();\n    // Everytime we update the cache, call each observer function\n    frameworkChangeObservers.forEach(function (fcn) {\n      return fcn();\n    });\n    // Retry once for either Unknown type after a delay (explained below)\n    resetTimeout(Framework.ServerSideUnknown, SSR_RESET_TIMEOUT);\n    resetTimeout(Framework.WebUnknown, WEB_RESET_TIMEOUT);\n  }\n  return frameworkCache;\n};\n/**\n * @internal Setup observer callback that will be called everytime the framework changes\n */\nexport var observeFrameworkChanges = function (fcn) {\n  frameworkChangeObservers.push(fcn);\n};\nexport function clearCache() {\n  frameworkCache = undefined;\n}\n// For a framework type and a delay amount, setup the event to re-detect\n//   During the runtime boot, it is possible that framework detection will\n//   be triggered before the framework has made modifications to the\n//   global/window/etc needed for detection. When no framework is detected\n//   we will reset and try again to ensure we don't use a cached\n//   non-framework detection result for all requests.\nfunction resetTimeout(framework, delay) {\n  if (frameworkCache === framework && !resetTriggered) {\n    setTimeout(function () {\n      clearCache();\n      resetTriggered = true;\n      setTimeout(detectFramework, PRIME_FRAMEWORK_DELAY);\n    }, delay);\n  }\n}","map":{"version":3,"names":["Framework","detect","frameworkCache","frameworkChangeObservers","resetTriggered","SSR_RESET_TIMEOUT","WEB_RESET_TIMEOUT","PRIME_FRAMEWORK_DELAY","detectFramework","forEach","fcn","resetTimeout","ServerSideUnknown","WebUnknown","observeFrameworkChanges","push","clearCache","undefined","framework","delay","setTimeout"],"sources":["C:/Users/geun/amplify-app/node_modules/@aws-amplify/core/lib-esm/Platform/detectFramework.js"],"sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport { Framework } from './types';\nimport { detect } from './detection';\n// We want to cache detection since the framework won't change\nvar frameworkCache;\nvar frameworkChangeObservers = [];\n// Setup the detection reset tracking / timeout delays\nvar resetTriggered = false;\nvar SSR_RESET_TIMEOUT = 10; // ms\nvar WEB_RESET_TIMEOUT = 10; // ms\nvar PRIME_FRAMEWORK_DELAY = 1000; // ms\nexport var detectFramework = function () {\n    if (!frameworkCache) {\n        frameworkCache = detect();\n        // Everytime we update the cache, call each observer function\n        frameworkChangeObservers.forEach(function (fcn) { return fcn(); });\n        // Retry once for either Unknown type after a delay (explained below)\n        resetTimeout(Framework.ServerSideUnknown, SSR_RESET_TIMEOUT);\n        resetTimeout(Framework.WebUnknown, WEB_RESET_TIMEOUT);\n    }\n    return frameworkCache;\n};\n/**\n * @internal Setup observer callback that will be called everytime the framework changes\n */\nexport var observeFrameworkChanges = function (fcn) {\n    frameworkChangeObservers.push(fcn);\n};\nexport function clearCache() {\n    frameworkCache = undefined;\n}\n// For a framework type and a delay amount, setup the event to re-detect\n//   During the runtime boot, it is possible that framework detection will\n//   be triggered before the framework has made modifications to the\n//   global/window/etc needed for detection. When no framework is detected\n//   we will reset and try again to ensure we don't use a cached\n//   non-framework detection result for all requests.\nfunction resetTimeout(framework, delay) {\n    if (frameworkCache === framework && !resetTriggered) {\n        setTimeout(function () {\n            clearCache();\n            resetTriggered = true;\n            setTimeout(detectFramework, PRIME_FRAMEWORK_DELAY);\n        }, delay);\n    }\n}\n"],"mappings":"AAAA;AACA;AACA,SAASA,SAAS,QAAQ,SAAS;AACnC,SAASC,MAAM,QAAQ,aAAa;AACpC;AACA,IAAIC,cAAc;AAClB,IAAIC,wBAAwB,GAAG,EAAE;AACjC;AACA,IAAIC,cAAc,GAAG,KAAK;AAC1B,IAAIC,iBAAiB,GAAG,EAAE,CAAC,CAAC;AAC5B,IAAIC,iBAAiB,GAAG,EAAE,CAAC,CAAC;AAC5B,IAAIC,qBAAqB,GAAG,IAAI,CAAC,CAAC;AAClC,OAAO,IAAIC,eAAe,GAAG,SAAAA,CAAA,EAAY;EACrC,IAAI,CAACN,cAAc,EAAE;IACjBA,cAAc,GAAGD,MAAM,CAAC,CAAC;IACzB;IACAE,wBAAwB,CAACM,OAAO,CAAC,UAAUC,GAAG,EAAE;MAAE,OAAOA,GAAG,CAAC,CAAC;IAAE,CAAC,CAAC;IAClE;IACAC,YAAY,CAACX,SAAS,CAACY,iBAAiB,EAAEP,iBAAiB,CAAC;IAC5DM,YAAY,CAACX,SAAS,CAACa,UAAU,EAAEP,iBAAiB,CAAC;EACzD;EACA,OAAOJ,cAAc;AACzB,CAAC;AACD;AACA;AACA;AACA,OAAO,IAAIY,uBAAuB,GAAG,SAAAA,CAAUJ,GAAG,EAAE;EAChDP,wBAAwB,CAACY,IAAI,CAACL,GAAG,CAAC;AACtC,CAAC;AACD,OAAO,SAASM,UAAUA,CAAA,EAAG;EACzBd,cAAc,GAAGe,SAAS;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAASN,YAAYA,CAACO,SAAS,EAAEC,KAAK,EAAE;EACpC,IAAIjB,cAAc,KAAKgB,SAAS,IAAI,CAACd,cAAc,EAAE;IACjDgB,UAAU,CAAC,YAAY;MACnBJ,UAAU,CAAC,CAAC;MACZZ,cAAc,GAAG,IAAI;MACrBgB,UAAU,CAACZ,eAAe,EAAED,qBAAqB,CAAC;IACtD,CAAC,EAAEY,KAAK,CAAC;EACb;AACJ"},"metadata":{},"sourceType":"module","externalDependencies":[]}